<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>For Aamira</title>

  <!-- Cinematic Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;500;600;700&family=Cormorant+Garamond:ital,wght@0,300;0,400;0,500;0,600;1,300;1,400&display=swap" rel="stylesheet">

  <!-- Preload critical GIFs -->
  <link rel="preload" as="image" href="https://media.tenor.com/Lgr_6-nkvnUAAAAi/casal-dudu.gif">

  <!-- Confetti -->
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.3/dist/confetti.browser.min.js"></script>

  <style>
    *, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }

    :root {
      --bg: #f5f0eb;
      --bg-warm: #f0ebe4;
      --bg-cool: #edeae6;
      --ink: #2a2320;
      --ink-light: #6b5e54;
      --ink-faint: #a89e94;
      --accent: #c4956a;
      --accent-warm: #d4a574;
      --white: #faf8f5;
    }

    html { scroll-behavior: smooth; }

    body {
      font-family: 'Cormorant Garamond', serif;
      background: var(--bg);
      color: var(--ink);
      overflow-x: hidden;
      min-height: 100dvh;
      -webkit-tap-highlight-color: transparent;
    }

    /* ─── SCREENS ─── */
    .screen {
      display: none;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 100dvh;
      padding: 2rem 1.5rem;
      position: relative;
      z-index: 1;
      text-align: center;
    }
    .screen.active { display: flex; }

    /* ─── FADE ─── */
    .fade-in {
      opacity: 0;
      transform: translateY(16px);
      animation: fadeIn 0.7s ease forwards;
    }
    @keyframes fadeIn {
      to { opacity: 1; transform: translateY(0); }
    }

    /* ────────────────────────────────────────
       SCREEN 1 — DANDELION WISH
    ──────────────────────────────────────── */
    #dandelion-screen {
      background: var(--bg);
      gap: 2rem;
      cursor: default;
      user-select: none;
      overflow: hidden;
    }

    .dandelion-prompt {
      font-family: 'Cinzel', serif;
      font-size: clamp(1.1rem, 3.5vw, 1.5rem);
      font-weight: 400;
      color: var(--ink-light);
      letter-spacing: 0.12em;
      text-transform: uppercase;
    }

    .dandelion-sub {
      font-family: 'Cormorant Garamond', serif;
      font-size: clamp(1rem, 3vw, 1.2rem);
      font-style: italic;
      color: var(--ink-faint);
      margin-top: -0.8rem;
    }

    /* Dandelion Container */
    .dandelion-wrap {
      position: relative;
      width: 260px;
      height: 380px;
      cursor: pointer;
      animation: dandelionSway 4s ease-in-out infinite;
    }

    @keyframes dandelionSway {
      0%, 100% { transform: rotate(0deg); }
      25% { transform: rotate(1.5deg); }
      75% { transform: rotate(-1.5deg); }
    }

    /* Stem */
    .dandelion-stem {
      position: absolute;
      bottom: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 2.5px;
      height: 200px;
      background: linear-gradient(to top, #6e8455, #8a9e6e);
      border-radius: 2px;
    }

    /* Small leaf on stem */
    .dandelion-leaf {
      position: absolute;
      bottom: 80px;
      left: calc(50% + 1px);
      width: 22px;
      height: 9px;
      background: #7d9460;
      border-radius: 0 70% 70% 0;
      transform: rotate(-20deg);
      transform-origin: left center;
    }

    /* Center bulb where seeds attach */
    .dandelion-head {
      position: absolute;
      bottom: 196px;
      left: 50%;
      transform: translateX(-50%);
      width: 10px;
      height: 12px;
      background: radial-gradient(circle, #b5ad9f 40%, #a09888 100%);
      border-radius: 50% 50% 40% 40%;
      z-index: 2;
    }

    /* Each seed — thin stalk + feathery pappus on top */
    .seed {
      position: absolute;
      bottom: 202px;
      left: 50%;
      margin-left: -0.5px;
      transform-origin: bottom center;
      z-index: 3;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .seed-stalk {
      width: 1.2px;
      background: linear-gradient(to top, #b0a898, rgba(190, 182, 170, 0.5));
      margin: 0 auto;
    }

    /* The feathery pappus (umbrella) */
    .seed-pappus {
      position: relative;
      width: 20px;
      height: 20px;
    }

    /* Radiating wisps — more visible */
    .seed-pappus::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 3px;
      height: 3px;
      background: rgba(180, 172, 158, 0.95);
      border-radius: 50%;
      transform: translate(-50%, -50%);
      box-shadow:
        0 -7px 0 0 rgba(175, 168, 155, 0.7),
        0 7px 0 0 rgba(175, 168, 155, 0.7),
        -7px 0 0 0 rgba(175, 168, 155, 0.7),
        7px 0 0 0 rgba(175, 168, 155, 0.7),
        -5px -5px 0 0 rgba(175, 168, 155, 0.6),
        5px -5px 0 0 rgba(175, 168, 155, 0.6),
        -5px 5px 0 0 rgba(175, 168, 155, 0.6),
        5px 5px 0 0 rgba(175, 168, 155, 0.6),
        0 -11px 0 -1px rgba(175, 168, 155, 0.35),
        0 11px 0 -1px rgba(175, 168, 155, 0.35),
        -11px 0 0 -1px rgba(175, 168, 155, 0.35),
        11px 0 0 -1px rgba(175, 168, 155, 0.35);
    }

    /* Outer glow — visible fluffy haze */
    .seed-pappus::after {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 24px;
      height: 24px;
      transform: translate(-50%, -50%);
      background: radial-gradient(circle, rgba(195, 188, 175, 0.4) 0%, transparent 70%);
      border-radius: 50%;
    }

    /* Blown seed animation */
    .seed.blown {
      animation: seedFloat var(--duration, 4s) var(--delay, 0s) ease-out forwards;
    }

    @keyframes seedFloat {
      0% {
        opacity: 1;
        transform: translate(0, 0) rotate(var(--start-rot, 0deg)) scale(1);
      }
      15% {
        opacity: 1;
      }
      100% {
        opacity: 0;
        transform:
          translate(var(--tx, 200px), var(--ty, -400px))
          rotate(var(--rot, 180deg))
          scale(0.4);
      }
    }

    /* After blown — bare stem */
    .dandelion-wrap.blown .dandelion-head {
      background: radial-gradient(circle, #b5ad9f 40%, #a09888 100%);
    }
    .dandelion-wrap.blown {
      animation: none;
    }

    .blow-hint {
      font-family: 'Cormorant Garamond', serif;
      font-size: 0.95rem;
      color: var(--ink-faint);
      animation: pulse 2.5s ease-in-out infinite;
    }

    @keyframes pulse {
      0%, 100% { opacity: 0.4; }
      50% { opacity: 1; }
    }

    .dandelion-wrap.blown ~ .blow-hint {
      display: none;
    }

    /* ────────────────────────────────────────
       SCREEN 2 — INTRO
    ──────────────────────────────────────── */
    #intro {
      background: var(--bg-warm);
      gap: 2rem;
    }

    .intro-sticker {
      width: 200px;
      height: 200px;
      border-radius: 50%;
      overflow: hidden;
    }

    .intro-sticker img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .intro-greeting {
      font-family: 'Cinzel', serif;
      font-size: clamp(1.8rem, 6vw, 3rem);
      font-weight: 400;
      color: var(--ink);
      letter-spacing: 0.06em;
    }

    .intro-sub {
      font-size: clamp(1.05rem, 3vw, 1.25rem);
      color: var(--ink-light);
      max-width: 360px;
      line-height: 1.7;
      font-weight: 300;
    }

    .btn-primary {
      background: var(--ink);
      color: var(--white);
      border: none;
      padding: 14px 44px;
      font-family: 'Cinzel', serif;
      font-size: 0.85rem;
      font-weight: 500;
      letter-spacing: 0.18em;
      text-transform: uppercase;
      cursor: pointer;
      transition: background 0.3s, transform 0.2s;
    }
    .btn-primary:hover { background: #3d3530; transform: translateY(-1px); }
    .btn-primary:active { transform: translateY(0); }

    /* ────────────────────────────────────────
       SCREEN 3 — THE ASK
    ──────────────────────────────────────── */
    #ask {
      background: var(--bg);
      gap: 1.8rem;
      position: relative;
      overflow: hidden;
    }

    .ask-sticker {
      width: 220px;
      height: 220px;
      overflow: hidden;
      border-radius: 16px;
      transition: all 0.3s ease;
    }

    .ask-sticker img {
      width: 100%;
      height: 100%;
      object-fit: contain;
    }

    .ask-question {
      font-family: 'Cinzel', serif;
      font-size: clamp(1.4rem, 5.5vw, 2.4rem);
      font-weight: 400;
      color: var(--ink);
      letter-spacing: 0.04em;
      line-height: 1.4;
      max-width: 480px;
    }

    .btn-area {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 1.5rem;
      margin-top: 0.5rem;
    }

    .btn-yes {
      background: var(--ink);
      color: var(--white);
      border: none;
      padding: 14px 40px;
      font-family: 'Cinzel', serif;
      font-size: 0.9rem;
      font-weight: 600;
      letter-spacing: 0.15em;
      text-transform: uppercase;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    .btn-yes:hover { background: #3d3530; transform: translateY(-2px); }

    /* No button lives in a bounded container so it never disappears */
    .no-zone {
      position: relative;
      width: 320px;
      height: 70px;
    }

    .btn-no {
      position: absolute;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%);
      background: transparent;
      color: var(--ink);
      border: 1.5px solid var(--ink);
      padding: 14px 40px;
      font-family: 'Cinzel', serif;
      font-size: 0.9rem;
      font-weight: 400;
      letter-spacing: 0.15em;
      text-transform: uppercase;
      cursor: pointer;
      transition: transform 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
      white-space: nowrap;
    }

    /* ────────────────────────────────────────
       SCREEN 5 — CELEBRATION
    ──────────────────────────────────────── */
    #celebration {
      background: var(--bg-warm);
      gap: 2rem;
    }

    .celeb-sticker {
      width: 240px;
      height: 240px;
      overflow: hidden;
      border-radius: 20px;
      animation: celebFloat 3s ease-in-out infinite;
    }

    .celeb-sticker img {
      width: 100%;
      height: 100%;
      object-fit: contain;
    }

    @keyframes celebFloat {
      0%, 100% { transform: translateY(0) rotate(-1deg); }
      50% { transform: translateY(-8px) rotate(1deg); }
    }

    .celeb-title {
      font-family: 'Cinzel', serif;
      font-size: clamp(1.6rem, 6vw, 2.8rem);
      font-weight: 400;
      color: var(--ink);
      letter-spacing: 0.06em;
    }

    .celeb-message {
      font-size: clamp(1.05rem, 3vw, 1.2rem);
      color: var(--ink-light);
      max-width: 400px;
      line-height: 1.8;
      font-weight: 300;
    }

    .celeb-foreshadow {
      margin-top: 0.5rem;
      padding: 24px 32px;
      border: 1.5px solid var(--ink-faint);
      max-width: 400px;
    }

    .celeb-foreshadow p {
      font-size: 1rem;
      color: var(--ink);
      line-height: 1.7;
    }

    .celeb-foreshadow .hint {
      font-family: 'Cinzel', serif;
      font-size: 1rem;
      font-weight: 500;
      color: var(--accent);
      letter-spacing: 0.08em;
      margin-top: 10px;
    }

    .envelope-icon {
      font-size: 1.8rem;
      display: inline-block;
      animation: envelopeFloat 3s ease-in-out infinite;
    }

    @keyframes envelopeFloat {
      0%, 100% { transform: translateY(0) rotate(0deg); }
      50% { transform: translateY(-4px) rotate(3deg); }
    }

    /* ─── SCREEN SHAKE ─── */
    .shake { animation: shakeIt 0.35s ease-in-out; }
    @keyframes shakeIt {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-6px); }
      50% { transform: translateX(6px); }
      75% { transform: translateX(-4px); }
    }

    /* ─── FLOATING PARTICLES BG ─── */
    .particles-bg {
      position: fixed;
      inset: 0;
      pointer-events: none;
      z-index: 0;
      overflow: hidden;
    }

    .particle {
      position: absolute;
      bottom: -20px;
      opacity: 0;
      animation: particleRise linear infinite;
    }

    @keyframes particleRise {
      0%   { opacity: 0; transform: translateY(0) translateX(0); }
      15%  { opacity: 0.4; }
      85%  { opacity: 0.2; }
      100% { opacity: 0; transform: translateY(-105dvh) translateX(var(--drift, 30px)); }
    }

    /* ─── REDUCED MOTION ─── */
    @media (prefers-reduced-motion: reduce) {
      .particle, .seed.blown, .celeb-sticker, .envelope-icon { animation: none !important; }
      .fade-in { animation: none !important; opacity: 1; transform: none; }
    }
  </style>
</head>
<body>

  <!-- Subtle floating particles -->
  <div class="particles-bg" id="particlesBg"></div>

  <!-- ═══════ SCREEN 1 — DANDELION WISH ═══════ -->
  <section class="screen active" id="dandelion-screen">
    <p class="dandelion-prompt fade-in">Make a wish</p>
    <p class="dandelion-sub fade-in" style="animation-delay:0.3s">then blow</p>

    <div class="dandelion-wrap" id="dandelionWrap" onclick="blowDandelion()">
      <!-- Seeds generated by JS -->
      <div class="dandelion-head" id="dandelionHead"></div>
      <div class="dandelion-stem"></div>
      <div class="dandelion-leaf"></div>
    </div>

    <p class="blow-hint fade-in" style="animation-delay:0.6s" id="blowHint">tap the dandelion</p>
  </section>

  <!-- ═══════ SCREEN 2 — INTRO ═══════ -->
  <section class="screen" id="intro">
    <div class="intro-sticker">
      <img src="https://media.tenor.com/Lgr_6-nkvnUAAAAi/casal-dudu.gif"
           alt="Dudu and Bubu with hearts">
    </div>
    <h1 class="intro-greeting fade-in">Hey, Aamira</h1>
    <p class="intro-sub fade-in" style="animation-delay:0.3s">
      I made something for you. It'll only take a minute.
    </p>
    <button class="btn-primary fade-in" style="animation-delay:0.6s" onclick="goTo('ask')">
      Continue
    </button>
  </section>

  <!-- ═══════ SCREEN 3 — THE ASK ═══════ -->
  <section class="screen" id="ask">
    <div class="ask-sticker" id="askSticker">
      <img id="askGif"
           src="https://media.tenor.com/0cNM_9li440AAAAi/dudu-giving-flowers-bubu-flowers.gif"
           alt="Dudu giving Bubu flowers">
    </div>

    <h2 class="ask-question fade-in">Aamira, do you want to be my Valentine?</h2>

    <div class="btn-area fade-in" style="animation-delay:0.3s">
      <button class="btn-yes" id="btnYes" onclick="handleYes()">Yes</button>
      <div class="no-zone" id="noZone">
        <button class="btn-no" id="btnNo">No</button>
      </div>
    </div>
  </section>

  <!-- ═══════ SCREEN 5 — CELEBRATION ═══════ -->
  <section class="screen" id="celebration">
    <div class="celeb-sticker">
      <img src="https://media.tenor.com/PZhfg9F3Dg8AAAAi/tkthao219-bubududu.gif"
           alt="Dudu hugging Bubu"
           loading="lazy">
    </div>

    <h2 class="celeb-title fade-in">I knew you would</h2>

    <p class="celeb-message fade-in" style="animation-delay:0.3s">
      You just made me the happiest person.
      I can't stop smiling right now.
      This Valentine's Day is going to be ours, Aamira.
    </p>

    <div class="celeb-foreshadow fade-in" style="animation-delay:0.6s">
      <p>
        <span class="envelope-icon">&#x1F48C;</span><br>
        This isn't your only surprise.
      </p>
      <p class="hint">February 14th &mdash; check your hands.</p>
    </div>
  </section>

  <script>
    // ═══════════════════════════════════════
    //  SUBTLE FLOATING PARTICLES
    // ═══════════════════════════════════════
    (function initParticles() {
      const prefersReduced = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
      if (prefersReduced) return;

      const bg = document.getElementById('particlesBg');
      const count = window.innerWidth < 600 ? 8 : 14;
      const chars = ['\u2727', '\u00B7', '\u2022', '\u2726'];

      for (let i = 0; i < count; i++) {
        const p = document.createElement('span');
        p.className = 'particle';
        p.textContent = chars[Math.floor(Math.random() * chars.length)];
        p.style.left = Math.random() * 100 + '%';
        p.style.fontSize = (8 + Math.random() * 10) + 'px';
        p.style.color = 'rgba(42,35,32,' + (0.08 + Math.random() * 0.1) + ')';
        p.style.animationDuration = (14 + Math.random() * 16) + 's';
        p.style.animationDelay = (Math.random() * 18) + 's';
        p.style.setProperty('--drift', (Math.random() * 60 - 30) + 'px');
        bg.appendChild(p);
      }
    })();

    // ═══════════════════════════════════════
    //  DANDELION
    // ═══════════════════════════════════════
    const SEED_COUNT = 24;
    const dandelionWrap = document.getElementById('dandelionWrap');
    const dandelionHead = document.getElementById('dandelionHead');
    let dandelionBlown = false;

    // Build seeds — perfectly uniform radial pattern, no random jitter
    (function buildDandelion() {
      const stalkLen = 50;
      for (let i = 0; i < SEED_COUNT; i++) {
        const angle = (i / SEED_COUNT) * 360;
        const angleRad = (angle * Math.PI) / 180;

        const seed = document.createElement('div');
        seed.className = 'seed';
        seed.style.transform = `rotate(${angle}deg)`;

        const pappus = document.createElement('div');
        pappus.className = 'seed-pappus';

        const stalk = document.createElement('div');
        stalk.className = 'seed-stalk';
        stalk.style.height = stalkLen + 'px';

        seed.appendChild(pappus);
        seed.appendChild(stalk);

        // Flight path randomness only applies to blow animation
        const distance = 200 + Math.random() * 400;
        const tx = Math.cos(angleRad) * distance * (0.5 + Math.random() * 0.8);
        const ty = -Math.abs(Math.sin(angleRad) * distance) - 80 - Math.random() * 250;
        const rot = (Math.random() * 360 - 180);
        const duration = 2.5 + Math.random() * 3;
        const delay = Math.random() * 1;

        seed.style.setProperty('--start-rot', angle + 'deg');
        seed.style.setProperty('--tx', tx + 'px');
        seed.style.setProperty('--ty', ty + 'px');
        seed.style.setProperty('--rot', rot + 'deg');
        seed.style.setProperty('--duration', duration + 's');
        seed.style.setProperty('--delay', delay + 's');

        dandelionWrap.insertBefore(seed, dandelionHead);
      }
    })();

    function blowDandelion() {
      if (dandelionBlown) return;
      dandelionBlown = true;
      dandelionWrap.classList.add('blown');

      // Blow all seeds
      const seeds = dandelionWrap.querySelectorAll('.seed');
      seeds.forEach(s => s.classList.add('blown'));

      // Hide hint
      document.getElementById('blowHint').style.display = 'none';

      // Transition to intro after seeds scatter
      setTimeout(() => goTo('intro'), 3200);
    }

    // ═══════════════════════════════════════
    //  NAVIGATION
    // ═══════════════════════════════════════
    function goTo(screenId) {
      document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
      const target = document.getElementById(screenId);
      target.classList.add('active');

      target.querySelectorAll('.fade-in').forEach(el => {
        el.style.animation = 'none';
        el.offsetHeight;
        el.style.animation = '';
      });
      window.scrollTo(0, 0);

      // Initialize No button position when Ask screen opens
      if (screenId === 'ask') initNoButton();
    }

    // ═══════════════════════════════════════
    //  NO BUTTON — DODGES CURSOR
    // ═══════════════════════════════════════
    let noCount = 0;
    const btnYes = document.getElementById('btnYes');
    const btnNo = document.getElementById('btnNo');
    const noZone = document.getElementById('noZone');
    const askScreen = document.getElementById('ask');
    const askGif = document.getElementById('askGif');
    const askSticker = document.getElementById('askSticker');

    const noMessages = [
      'No',
      'Are you sure?',
      'Really sure?',
      'Think again',
      'Pretty please?',
      'With ice cream on top?',
      'I\'ll cook for you',
      'I\'ll let you pick the movie',
      'PLEASE AAMIRA',
      'I\'m going to cry',
      'ok I\'m crying now',
      'actually I\'m fine',
      '...no I\'m not fine',
      'JUST SAY YES',
      'I\'ll ask again tomorrow',
      'and the day after that',
    ];

    // GIF stages — all transparent/white backgrounds
    const askGifs = [
      // 0: hopeful — dudu giving flowers
      'https://media.tenor.com/0cNM_9li440AAAAi/dudu-giving-flowers-bubu-flowers.gif',
      // 1: shy — dudu shy with flowers
      'https://media.tenor.com/-HF7-xdOAAwAAAAx/bubu-dudu-bubu-dudu-shy.webp',
      // 2: still pleading — panda shy
      'https://media.tenor.com/XFYEWpH5LxwAAAAi/bear-panda.gif',
      // 3: getting sad — bubu sad face
      'https://media.tenor.com/-D3LBHnOy-8AAAAi/bubu-sad-bubu-crying.gif',
      // 4: sad — bubu sad face
      'https://media.tenor.com/-D3LBHnOy-8AAAAi/bubu-sad-bubu-crying.gif',
      // 5: crying — panda with tissues
      'https://media.tenor.com/9gBByPt6k4oAAAAi/bubu-dudu-twitter.gif',
      // 6: crying harder — big tears
      'https://media.tenor.com/HUJyzO0WfM4AAAAi/bubu-dudu.gif',
      // 7: brown bear crying
      'https://media.tenor.com/yZoKXA08ZyYAAAAi/bubu-bubu-dudu.gif',
      // 8: not happy — pouty
      'https://media.tenor.com/iszesSNWYY4AAAAi/bubu-not-happy-not-now.gif',
      // 9: angry walk
      'https://media.tenor.com/zyud8rY84swAAAAi/bubu-bubu-angry.gif',
      // 10+: cycle through crying/sad
      'https://media.tenor.com/9gBByPt6k4oAAAAi/bubu-dudu-twitter.gif',
      'https://media.tenor.com/HUJyzO0WfM4AAAAi/bubu-dudu.gif',
      'https://media.tenor.com/yZoKXA08ZyYAAAAi/bubu-bubu-dudu.gif',
      'https://media.tenor.com/9gBByPt6k4oAAAAi/bubu-dudu-twitter.gif',
      'https://media.tenor.com/HUJyzO0WfM4AAAAi/bubu-dudu.gif',
      'https://media.tenor.com/9gBByPt6k4oAAAAi/bubu-dudu-twitter.gif',
    ];

    // Preload all GIF stages
    askGifs.forEach(src => { const img = new Image(); img.src = src; });

    function initNoButton() {
      noCount = 0;
      btnNo.textContent = 'No';
      btnNo.style.transform = 'translate(-50%, -50%)';
      btnYes.style.fontSize = '';
      btnYes.style.padding = '';
      askSticker.style.width = '';
      askSticker.style.height = '';
      askGif.src = askGifs[0];
    }

    function dodgeNo() {
      noCount++;
      const idx = Math.min(noCount, noMessages.length - 1);

      // Update No button text
      btnNo.textContent = noMessages[idx];

      // Grow Yes button
      const yesFontSize = 0.9 + noCount * 0.12;
      const yesPad = 14 + noCount * 3;
      btnYes.style.fontSize = yesFontSize + 'rem';
      btnYes.style.padding = `${yesPad}px ${yesPad + 26}px`;

      // Swap GIF
      const gifIdx = Math.min(noCount, askGifs.length - 1);
      askGif.src = askGifs[gifIdx];

      // Grow sticker
      const size = 220 + noCount * 5;
      askSticker.style.width = size + 'px';
      askSticker.style.height = size + 'px';

      // Screen shake
      askScreen.classList.remove('shake');
      void askScreen.offsetHeight;
      askScreen.classList.add('shake');

      // Dodge within the no-zone bounds using transform
      // Random offset from center: +-100px horizontal, +-10px vertical
      const offsetX = (Math.random() - 0.5) * 200;
      const offsetY = (Math.random() - 0.5) * 20;
      btnNo.style.transform = `translate(calc(-50% + ${offsetX}px), calc(-50% + ${offsetY}px))`;
    }

    // Click-based dodge — she can see the button, aim for it, click it,
    // and THEN it runs away. She sees the text change each time.
    btnNo.addEventListener('click', dodgeNo);

    // ═══════════════════════════════════════
    //  YES — CELEBRATION
    // ═══════════════════════════════════════
    function handleYes() {
      goTo('celebration');
      fireCelebration();
    }

    function fireCelebration() {
      const prefersReduced = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
      if (prefersReduced) return;

      const heart = confetti.shapeFromText({ text: '\u2764\uFE0F', scalar: 2 });
      const pink = confetti.shapeFromText({ text: '\u{1F497}', scalar: 2 });
      const sparkle = confetti.shapeFromText({ text: '\u2728', scalar: 2 });
      const rose = confetti.shapeFromText({ text: '\u{1F339}', scalar: 2 });

      // Big initial burst
      setTimeout(() => {
        confetti({
          particleCount: 80,
          spread: 100,
          origin: { x: 0.5, y: 0.45 },
          colors: ['#c4956a', '#d4a574', '#2a2320', '#a89e94', '#f5f0eb'],
          shapes: [heart, pink, sparkle, 'circle'],
          scalar: 2.2,
          gravity: 0.8,
          disableForReducedMotion: true,
        });
      }, 200);

      // Sustained stream
      const end = Date.now() + 3500;
      (function frame() {
        confetti({
          particleCount: 2,
          angle: 60,
          spread: 50,
          origin: { x: 0, y: 0.6 },
          colors: ['#c4956a', '#d4a574', '#a89e94'],
          shapes: [heart, rose, sparkle, 'circle'],
          scalar: 2,
          disableForReducedMotion: true,
        });
        confetti({
          particleCount: 2,
          angle: 120,
          spread: 50,
          origin: { x: 1, y: 0.6 },
          colors: ['#c4956a', '#d4a574', '#a89e94'],
          shapes: [heart, rose, sparkle, 'circle'],
          scalar: 2,
          disableForReducedMotion: true,
        });
        if (Date.now() < end) requestAnimationFrame(frame);
      })();
    }
  </script>
</body>
</html>
